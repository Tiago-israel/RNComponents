var Z=Object.defineProperty;var J=(t,n,e)=>n in t?Z(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var d=(t,n,e)=>J(t,typeof n!="symbol"?n+"":n,e);import{j as T}from"./jsx-runtime-D_zvdyIk.js";import{r as f,R as A}from"./index-DvOVhSYJ.js";import{R as O,S as h,a as K,T as p,C as l,t as U,g as N,c as Y,b as C,f as y,r as W,e as X,A as b,s as P,d as v,M as V,u as Q,i as ee,h as te,j as k,v as ne,k as ae,l as re,m as se,n as ie,o as oe,p as le,B as w,q as R,w as ce,H as ue}from"./index-Y41CTrZP.js";import{P as j,A as S}from"./index-DJTcU2v7.js";import{V as de,s as he}from"./index-CTWxeKSo.js";import{M as fe}from"./index-T7UHIOwT.js";function ge(t,n){"worklet";switch(t){case l.BEGAN:return n.onBegin;case l.START:return n.onStart;case l.UPDATE:return n.onUpdate;case l.CHANGE:return n.onChange;case l.END:return n.onEnd;case l.FINALIZE:return n.onFinalize;case l.TOUCHES_DOWN:return n.onTouchesDown;case l.TOUCHES_MOVE:return n.onTouchesMove;case l.TOUCHES_UP:return n.onTouchesUp;case l.TOUCHES_CANCELLED:return n.onTouchesCancelled}}function me(t){"worklet";switch(t){case p.TOUCHES_DOWN:return l.TOUCHES_DOWN;case p.TOUCHES_MOVE:return l.TOUCHES_MOVE;case p.TOUCHES_UP:return l.TOUCHES_UP;case p.TOUCHES_CANCELLED:return l.TOUCHES_CANCELLED}return l.UNDEFINED}function m(t,n,e,...r){"worklet";const i=ge(t,n);n.isWorklet[t]?i==null||i(e,...r):i&&console.warn(U("Animated gesture callback must be a worklet"))}function Ee(t){"worklet";return t.oldState!=null}function Te(t){"worklet";return t.eventType!=null}function Ce(t,n){if(!O)return;const e=O.useSharedValue(null),r=O.useSharedValue([]),i=[],a=s=>{"worklet";var E;const u=e.value;if(u)for(let g=0;g<u.length;g++){const c=u[g];s.handlerTag===c.handlerTag&&(Ee(s)?s.oldState===h.UNDETERMINED&&s.state===h.BEGAN?m(l.BEGAN,c,s):(s.oldState===h.BEGAN||s.oldState===h.UNDETERMINED)&&s.state===h.ACTIVE?(m(l.START,c,s),r.value[c.handlerTag]=void 0):s.oldState!==s.state&&s.state===h.END?(s.oldState===h.ACTIVE&&m(l.END,c,s,!0),m(l.FINALIZE,c,s,!0)):(s.state===h.FAILED||s.state===h.CANCELLED)&&s.state!==s.oldState&&(s.oldState===h.ACTIVE&&m(l.END,c,s,!1),m(l.FINALIZE,c,s,!1)):Te(s)?((!i[g]||i[g].handlerTag!==s.handlerTag)&&(i[g]=K.create(s.handlerTag)),s.eventType!==p.UNDETERMINED&&m(me(s.eventType),c,s,i[g])):(m(l.UPDATE,c,s),c.onChange&&c.changeEventCalculator&&(m(l.CHANGE,c,(E=c.changeEventCalculator)==null?void 0:E.call(c,s,r.value[c.handlerTag])),r.value[c.handlerTag]=s)))}},o=O.useEvent(a,["onGestureHandlerStateChange","onGestureHandlerEvent"],n);t.animatedEventHandler=o,t.animatedHandlers=e}function B({preparedGesture:t,gestureConfig:n,gesturesToAttach:e,viewTag:r,webEventHandlersRef:i}){n.initialize(),N(()=>{t.isMounted&&n.prepare()});for(const a of e)Y(a),C.createGestureHandler(a.handlerName,a.handlerTag,y(a.config,b)),W(a.handlerTag,a,a.config.testId);N(()=>{if(t.isMounted){for(const a of e)C.updateGestureHandler(a.handlerTag,y(a.config,b,X(a)));P()}});for(const a of e){const o=a.shouldUseReanimated?v.REANIMATED_WORKLET:v.JS_FUNCTION_NEW_API;j.OS==="web"?C.attachGestureHandler(a.handlerTag,r,v.JS_FUNCTION_OLD_API,i):C.attachGestureHandler(a.handlerTag,r,o),V.gestureWillMount(a)}if(t.attachedGestures=e,t.animatedHandlers){const a=o=>o.shouldUseReanimated;t.animatedHandlers.value=e.filter(a).map(o=>o.handlers)}}function q(t,n){if(n.length!==t.attachedGestures.length)return!0;for(let e=0;e<n.length;e++)if(n[e].handlerName!==t.attachedGestures[e].handlerName||n[e].shouldUseReanimated!==t.attachedGestures[e].shouldUseReanimated)return!0;return!1}function z(t){for(const n of t.attachedGestures)C.dropGestureHandler(n.handlerTag),Q(n.handlerTag,n.config.testId),V.gestureWillUnmount(n);P()}const $=f.forwardRef(({children:t},n)=>{try{const e=A.Children.only(t);return ee(e)?A.cloneElement(e,{ref:n},e.props.children):T.jsx("div",{ref:n,style:{display:"contents"},children:e})}catch{throw new Error(U("GestureDetector got more than one view as a child. If you want the gesture to work on multiple views, wrap them with a common parent and attach the gesture to that view."))}}),pe=$;function we(t,n,e){n.prepare();for(let i=0;i<e.length;i++){const a=t.attachedGestures[i];Y(a),e[i].handlerTag!==a.handlerTag&&(e[i].handlerTag=a.handlerTag,e[i].handlers.handlerTag=a.handlerTag)}const r=t.attachedGestures;N(()=>{if(!t.isMounted||r!==t.attachedGestures)return;let i=r.length!==e.length;for(let a=0;a<e.length;a++){const o=r[a];o.handlers.gestureId!==e[a].handlers.gestureId&&(e[a].shouldUseReanimated||o.shouldUseReanimated)&&(i=!0),o.config=e[a].config,o.handlers=e[a].handlers,C.updateGestureHandler(o.handlerTag,y(o.config,b,X(o))),W(o.handlerTag,o,o.config.testId)}if(t.animatedHandlers&&i){const a=r.filter(o=>o.shouldUseReanimated).map(o=>o.handlers);t.animatedHandlers.value=a}P()})}function Re(t,n,e,r,i){const a=te();return f.useCallback(s=>{const u=k(t.viewRef),E=u!==t.previousViewTag;E||q(n,e)?(ne(t.viewRef),z(n),B({preparedGesture:n,gestureConfig:r,gesturesToAttach:e,webEventHandlersRef:i,viewTag:u}),E&&(t.previousViewTag=u,t.forceRebuildReanimatedEvent=!0,a())):s||we(n,r,e)},[a,r,e,n,t,i])}function He(t){return null}function Oe(t,n){return f.useCallback(r=>{if(r!==null&&(t.viewRef=r,t.previousViewTag===-1&&(t.previousViewTag=k(t.viewRef)),t.firstRender||n(!0),__DEV__&&ae()&&global.isViewFlatteningDisabled)){const i=He();global.isViewFlatteningDisabled(i)===!1&&console.error(U("GestureDetector has received a child that may get view-flattened. \nTo prevent it from misbehaving you need to wrap the child with a `<View collapsable={false}>`."))}},[t,n])}function D(t,n){if(t===void 0)return!1;for(const e of re(t))if(e===n.handlerTag)return!0;return!1}function Ge(t,n){f.useEffect(()=>V.addMountListener(e=>{for(const r of n.attachedGestures){const i=r.config.blocksHandlers,a=r.config.requireToFail,o=r.config.simultaneousWith;if(D(i,e)||D(a,e)||D(o,e)){t();return}}}),[t,n])}function ve(t,n){const e=["userSelect","enableContextMenu","touchAction"];for(const r of e){const i=t[r];if(i!==void 0)for(const a of n.toGestureArray()){const o=a.config;o[r]=i}}}const Se=t=>{const n=f.useContext(se);if(__DEV__&&!n&&!ie()&&j.OS!=="web")throw new Error("GestureDetector must be used as a descendant of GestureHandlerRootView. Otherwise the gestures will not be recognized. See https://docs.swmansion.com/react-native-gesture-handler/docs/fundamentals/installation for more details.");if(!t.gesture)throw new Error("GestureDetector must have a gesture prop provided.");const e=t.gesture;ve(t,e);const r=f.useMemo(()=>e.toGestureArray(),[e]),i=r.some(c=>c.shouldUseReanimated),a=oe(),o=f.useRef({firstRender:!0,viewRef:null,previousViewTag:-1,forceRebuildReanimatedEvent:!1}).current,s=A.useRef({attachedGestures:[],animatedEventHandler:null,animatedHandlers:null,shouldUseReanimated:i,isMounted:!1}).current,u=Re(o,s,r,e,a),E=Oe(o,u),g=o.firstRender||o.forceRebuildReanimatedEvent||q(s,r);return o.forceRebuildReanimatedEvent=!1,Ce(s,g),le(()=>{const c=k(o.viewRef);return s.isMounted=!0,B({preparedGesture:s,gestureConfig:e,gesturesToAttach:r,webEventHandlersRef:a,viewTag:c}),()=>{s.isMounted=!1,z(s)}},[]),f.useEffect(()=>{o.firstRender?o.firstRender=!1:u()},[t]),Ge(u,s),i?T.jsx(pe,{ref:E,onGestureHandlerEvent:s.animatedEventHandler,children:t.children}):T.jsx($,{ref:E,children:t.children})};class De extends w{constructor(){super();d(this,"config",{});this.handlerName="FlingGestureHandler"}numberOfPointers(e){return this.config.numberOfPointers=e,this}direction(e){return this.config.direction=e,this}}function xe(t,n){"worklet";let e;return n===void 0?e={forceChange:t.force}:e={forceChange:t.force-n.force},{...t,...e}}class Ae extends R{constructor(){super();d(this,"config",{});this.handlerName="ForceTouchGestureHandler"}minForce(e){return this.config.minForce=e,this}maxForce(e){return this.config.maxForce=e,this}feedbackOnActivation(e){return this.config.feedbackOnActivation=e,this}onChange(e){return this.handlers.changeEventCalculator=xe,super.onChange(e)}}function F(t,n){return t===void 0?[...n]:[...t,...n]}class H extends ce{constructor(...e){super();d(this,"gestures",[]);d(this,"simultaneousGestures",[]);d(this,"requireGesturesToFail",[]);this.gestures=e}prepareSingleGesture(e,r,i){if(e instanceof w){const a={...e.config};a.simultaneousWith=F(a.simultaneousWith,r),a.requireToFail=F(a.requireToFail,i),e.config=a}else e instanceof H&&(e.simultaneousGestures=r,e.requireGesturesToFail=i,e.prepare())}prepare(){for(const e of this.gestures)this.prepareSingleGesture(e,this.simultaneousGestures,this.requireGesturesToFail)}initialize(){for(const e of this.gestures)e.initialize()}toGestureArray(){return this.gestures.flatMap(e=>e.toGestureArray())}}class Ne extends H{prepare(){const n=this.gestures.map(e=>this.gestures.filter(r=>r!==e).flatMap(r=>r.toGestureArray()));for(let e=0;e<this.gestures.length;e++)this.prepareSingleGesture(this.gestures[e],n[e],this.requireGesturesToFail)}}class ye extends H{prepare(){const n=this.gestures.map(r=>r.toGestureArray());let e=[];for(let r=0;r<this.gestures.length;r++)this.prepareSingleGesture(this.gestures[r],this.simultaneousGestures,this.requireGesturesToFail.concat(e)),e=e.concat(n[r])}}class be extends w{constructor(){super();d(this,"config",{});this.handlerName="LongPressGestureHandler",this.shouldCancelWhenOutside(!0)}minDuration(e){return this.config.minDurationMs=e,this}maxDistance(e){return this.config.maxDist=e,this}numberOfPointers(e){return this.config.numberOfPointers=e,this}}function Ue(t,n){"worklet";let e;return n===void 0?e={changeX:t.translationX,changeY:t.translationY}:e={changeX:t.translationX-n.translationX,changeY:t.translationY-n.translationY},{...t,...e}}class Pe extends R{constructor(){super();d(this,"config",{});this.handlerName="PanGestureHandler"}activeOffsetY(e){return Array.isArray(e)?(this.config.activeOffsetYStart=e[0],this.config.activeOffsetYEnd=e[1]):e<0?this.config.activeOffsetYStart=e:this.config.activeOffsetYEnd=e,this}activeOffsetX(e){return Array.isArray(e)?(this.config.activeOffsetXStart=e[0],this.config.activeOffsetXEnd=e[1]):e<0?this.config.activeOffsetXStart=e:this.config.activeOffsetXEnd=e,this}failOffsetY(e){return Array.isArray(e)?(this.config.failOffsetYStart=e[0],this.config.failOffsetYEnd=e[1]):e<0?this.config.failOffsetYStart=e:this.config.failOffsetYEnd=e,this}failOffsetX(e){return Array.isArray(e)?(this.config.failOffsetXStart=e[0],this.config.failOffsetXEnd=e[1]):e<0?this.config.failOffsetXStart=e:this.config.failOffsetXEnd=e,this}minPointers(e){return this.config.minPointers=e,this}maxPointers(e){return this.config.maxPointers=e,this}minDistance(e){return this.config.minDist=e,this}minVelocity(e){return this.config.minVelocity=e,this}minVelocityX(e){return this.config.minVelocityX=e,this}minVelocityY(e){return this.config.minVelocityY=e,this}averageTouches(e){return this.config.avgTouches=e,this}enableTrackpadTwoFingerGesture(e){return this.config.enableTrackpadTwoFingerGesture=e,this}activateAfterLongPress(e){return this.config.activateAfterLongPress=e,this}onChange(e){return this.handlers.changeEventCalculator=Ue,super.onChange(e)}}function Ve(t,n){"worklet";let e;return n===void 0?e={scaleChange:t.scale}:e={scaleChange:t.scale/n.scale},{...t,...e}}class ke extends R{constructor(){super(),this.handlerName="PinchGestureHandler"}onChange(n){return this.handlers.changeEventCalculator=Ve,super.onChange(n)}}function Fe(t,n){"worklet";let e;return n===void 0?e={rotationChange:t.rotation}:e={rotationChange:t.rotation-n.rotation},{...t,...e}}class Me extends R{constructor(){super(),this.handlerName="RotationGestureHandler"}onChange(n){return this.handlers.changeEventCalculator=Fe,super.onChange(n)}}class Ie extends w{constructor(){super();d(this,"config",{});this.handlerName="TapGestureHandler",this.shouldCancelWhenOutside(!0)}minPointers(e){return this.config.minPointers=e,this}numberOfTaps(e){return this.config.numberOfTaps=e,this}maxDistance(e){return this.config.maxDist=e,this}maxDuration(e){return this.config.maxDurationMs=e,this}maxDelay(e){return this.config.maxDelayMs=e,this}maxDeltaX(e){return this.config.maxDeltaX=e,this}maxDeltaY(e){return this.config.maxDeltaY=e,this}}class _e extends w{constructor(){super();d(this,"config",{});this.handlerName="NativeViewGestureHandler"}shouldActivateOnStart(e){return this.config.shouldActivateOnStart=e,this}disallowInterruption(e){return this.config.disallowInterruption=e,this}}function Le(t,n){"worklet";return t}class Ye extends R{constructor(){super(),this.handlerName="ManualGestureHandler"}onChange(n){return this.handlers.changeEventCalculator=Le,super.onChange(n)}}const We={Tap:()=>new Ie,Pan:()=>new Pe,Pinch:()=>new ke,Rotation:()=>new Me,Fling:()=>new De,LongPress:()=>new be,ForceTouch:()=>new Ae,Native:()=>new _e,Manual:()=>new Ye,Hover:()=>new ue,Race:(...t)=>new H(...t),Simultaneous(...t){return new Ne(...t)},Exclusive(...t){return new ye(...t)}},x=["#b58df1","#fa7f7c","#ffe780","#82cab2"];function Xe(){const t=f.useRef(new S.Value(0)).current,n=We.Tap().onStart(()=>{console.log("onStart")}),e=f.useRef(0),r=()=>{const a=(e.current+1)%x.length;e.current=a,S.timing(t,{toValue:a,duration:250,useNativeDriver:!1}).start()},i=t.interpolate({inputRange:x.map((a,o)=>o),outputRange:x});return T.jsx(Se,{gesture:n,children:T.jsx(de,{style:M.container,children:T.jsx(fe,{onPress:r,children:T.jsx(S.View,{style:[M.box,{backgroundColor:i}]})})})})}const M=he.create({container:{flex:1,alignItems:"center",justifyContent:"center"},box:{width:100,height:100,borderRadius:20,cursor:"pointer"}}),Ke={title:"Components/GestureBox",component:Xe,tags:["autodocs"],argTypes:{},parameters:{layout:"centered"}},G={args:{}};var I,_,L;G.parameters={...G.parameters,docs:{...(I=G.parameters)==null?void 0:I.docs,source:{originalSource:`{
  args: {}
}`,...(L=(_=G.parameters)==null?void 0:_.docs)==null?void 0:L.source}}};const Qe=["Default"];export{G as Default,Qe as __namedExportsOrder,Ke as default};
